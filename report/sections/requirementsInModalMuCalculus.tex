% !TEX root = ../report.tex

\newcommand{\tab}{\hspace{1em}}

\begin{description}
 \item[1. At least one door of a sluice is closed at any point in time]\mbox{}\\
\[
[true^*]\forall s:Sluice,d:Door.[openDoor(d, s).\overline{closeDoor(d, s)}^*.openDoor(d, s)]false
\]


 \item[2. No robot may interact with a sluice whenever its access door is closed]\mbox{}\\
\begin{align*}
& [true^*]\forall s:Sluice.( \\
& \tab [closeDoor(outsideDoor, s).(\overline{openDoor(outsideDoor, s)}^*.( \\
& \tab\tab move(RI, sluicePlace(s)) \cup move(sluicePlace(s), RI) \cup \\
& \tab\tab move(RO, sluicePlace(s)) \cup move(sluicePlace(s), RO) \\
& \tab )]false \wedge \\
& \tab [closeDoor(insideDoor, s).(\overline{openDoor(insideDoor, s)}^*.( \\
& \tab\tab move(I, sluicePlace(s)) \cup move(sluicePlace(s), I) \cup \\
& \tab\tab move(O, sluicePlace(s)) \cup move(sluicePlace(s), O) \\
& \tab )]false \\
& )
\end{align*}
 
 \item[3. Any wafer in the system will eventually be processed]

	\begin{align*}
& [true^*.detectInputWafer] \mu X( \\
&          \tab                          position: Place = RI,    \\  
&          \tab                          projecting: Bool = false,  \\
&          \tab                          projected: Bool = false,   \\
&          \tab                          stuck: Bool = false,       \\
&          \tab                          brokenDoors: SluiceDoor \to Bool = nothingBroken   \\
&                                 ).( \\
&  \tab ( \\
&  \tab\tab  \forall a,b:Place.[move(a,b)]X( \\
&  \tab\tab  \tab                              if(a \approx position, b, position), \\
&  \tab\tab  \tab                              projecting \wedge a \not \approx position, \\
&  \tab\tab  \tab                              projected, \\
&  \tab\tab  \tab                              if(a \approx position \wedge \exists s:Sluice . sluicePlace(s) \approx b \wedge ( \\
& \tab\tab\tab\tab (\neg projected \wedge brokenDoors(sluiceDoor(s, insideDoor))) \\ 
& \tab\tab\tab\tab \vee (projected \wedge brokenDoors(sluiceDoor(s, outsideDoor))) \\
& \tab\tab\tab ), true, stuck), \\
&  \tab\tab  \tab                              brokenDoors \\
&  \tab\tab                               ) \\
&  \tab\tab  \wedge [\overline{(\exists a,b:Place.move(a,b)) \cup beginProject \cup endProject} \\
& \tab\tab\tab\tab \overline{ \cup (\exists d:Door,s:Sluice.doorStuck(d, s))}]X( \\
& \tab\tab\tab\tab\tab\tab position, projecting, projected, stuck, brokenDoors) \\
&  \tab\tab  \wedge [beginProject]X(position, position \approx P, projected, stuck, brokenDoors)
&  \tab\tab  \wedge [endProject]X(position, false, projected \vee (projecting \wedge position \approx P), stuck, brokenDoors) \\
&  \tab\tab  \wedge \forall d:Door,s:Sluice.[doorStuck(d, s)]X( \\
&  \tab\tab                        \tab                        position, \\
&  \tab\tab                        \tab                        projecting, \\
&  \tab\tab                        \tab                        projected, \\
&  \tab\tab                        \tab                        if(sluicePlace(s) \approx position \wedge ((\neg projected \wedge d == insideDoor) \\
& \tab\tab\tab\tab\tab \vee (projected \wedge d == outsideDoor)), true, stuck), \\
&  \tab\tab                       \tab brokenDoors[sluiceDoor(s,d)\to true] \\
&  \tab\tab                                              ) \\
&  \tab ) \\
&  \vee (position \approx RO \wedge projected) \vee stuck \\
&)
	\end{align*}

 
 \item[4. Internal racks, sluices and the projector each contain at most one wafer]
    
\begin{align*}
		&[true*] \nu X(status:Place \to WaferState=emptyPlaces).(\\
  & \tab\tab [\overline{((\exists a,b:Place.move(a,b)) \cup detectInputWafer)}]X(status)\\
  & \tab\tab  \wedge [detectInputWafer]X(status[RI \to unprojected])\\
  & \tab\tab  \wedge \forall a,b:Place.[move(a, b)](val(status(a) != empty \implies status(b)  == empty) \wedge \\ & \tab \tab X(status[b \to status(a)][a \to empty]))\\
&)
	\end{align*}

 
 \item[5. When the projector is at work, no interaction with the wafer is permissible]
 	\begin{align*}
 		&[true^*.beginProject().\overline{endProject()}^*.move(P,O)]false
	\end{align*}
	
 \item[6. A sluice door cannot open until the pressure on both sides is equal]
%		&[true^*.vacuum(s).stopPumping(s).\overline{readAirPressure(s,0)^*}.openInside(s)]false \\
%		&[true^*.deVacuum(s).stopPumping(s).\overline{readAirPressure(s,1)^*}.openOutside(s)]false \\
	\begin{align*}
&[true^*]\forall s:Sluice . ( \\
&\tab  [vacuum(s).stopPumping(s).\overline{readAirPressure(s, vacuum)}^*\\
&\tab\tab\tab.openDoor(insideDoor,s)]false \\
&\tab  \wedge [deVacuum(s).stopPumping(s).\overline{readAirPressure(s, normal)}^*\\
&\tab\tab\tab.openDoor(outsideDoor,s)]false \\
&)		
	\end{align*}
	
 \item[7. Sluice pumps cannot operate until both of its doors are closed]
 
 \begin{align*}
		&\forall s:Sluice :[true^*.openInside(s).\overline{closeInside(s)^*}.vacuum(s)]false \\
		& \wedge [true^*.openInside(s).\overline{closeInside(s)^*}.deVacuum(s)]false \\
		& \wedge [true^*.openOutside(s).\overline{closeOutside(s)^*}.vacuum(s)]false \\
		& \wedge [true^*.openOutside(s).\overline{closeOutside(s)^*}.deVacuum(s)]false \\
	\end{align*}

 \item[8. No robot can place a projected wafer in $RI$]\mbox{}\\
$
[true^* \cdot detectInputWafer]\\
\nu X(position:Place=RI, projecting:Bool=false, projected:Bool=false)\\
.\forall a,b:Place.[move(a,b)]X(if(a \approx position, b, position), projecting \wedge a \not \approx position, projected)\\
\wedge [\overline{\exists a,b:Place.move(a,b) \cup beginProject \cup endProject)}]X(position, projecting, projected)\\
\wedge [beginProject]X(position, position \approx P, projected)\\
\wedge [endProject]X(position, false, projected \vee (projecting \wedge position \approx P))\\
\wedge (position \approx RI \implies \neg projected)
$
 \item[9. No robot can place an unprojected wafer in $RO$] \mbox{}\\
$
[true^* \cdot detectInputWafer]\\
\nu X(position:Place=RI, projecting:Bool=false, projected:Bool=false)\\
.\forall a,b:Place.[move(a,b)]X(if(a \approx position, b, position), projecting \wedge a \not \approx position, projected)\\
\wedge [\overline{\exists a,b:Place.move(a,b) \cup beginProject \cup endProject)}]X(position, projecting, projected)\\
\wedge [beginProject]X(position, position \approx P, projected)\\
\wedge [endProject]X(position, false, projected \vee (projecting \wedge position \approx P))\\
\wedge (position \approx RO \implies projected)
$

 \item[10. No robot can take a wafer from $RO$]

\[
	\forall p:Place . [true^* \cdot move(RO, p)]false
\]

\end{description}
