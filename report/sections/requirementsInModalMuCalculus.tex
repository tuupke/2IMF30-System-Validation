% !TEX root = ../report.tex

\newcommand{\tab}{\hspace{1em}}

\begin{description}
 \item[1. At least one door of a sluice is closed at any point in time]\mbox{}\\
\[
[true^*]\forall s:Sluice,d:Door.[openDoor(d, s).\overline{closeDoor(d, s)}^*.openDoor(d, s)]false
\]


 \item[2. No robot may interact with a sluice whenever its access door is closed]\mbox{}\\
\begin{align*}
& [true^*]\forall s:Sluice.( \\
& \tab [closeDoor(outsideDoor, s).(\overline{openDoor(outsideDoor, s)}^*.( \\
& \tab\tab move(RI, sluicePlace(s)) \cup move(sluicePlace(s), RI) \cup \\
& \tab\tab move(RO, sluicePlace(s)) \cup move(sluicePlace(s), RO) \\
& \tab )]false \wedge \\
& \tab [closeDoor(insideDoor, s).(\overline{openDoor(insideDoor, s)}^*.( \\
& \tab\tab move(I, sluicePlace(s)) \cup move(sluicePlace(s), I) \cup \\
& \tab\tab move(O, sluicePlace(s)) \cup move(sluicePlace(s), O) \\
& \tab )]false \\
& )
\end{align*}
 
 \item[\smash{\shortstack[l]{3. Any wafer in the system will eventually be processed unless the system breaks,\\ or the wafer is inside a sluice when the sluice itself breaks}}]

	\begin{align*}
& [true^*.detectInputWafer] \mu X( \\
&          \tab                          position: Place = RI,    \\  
&          \tab                          projecting: Bool = false,  \\
&          \tab                          projected: Bool = false,   \\
&          \tab                          stuck: Bool = false,       \\
&          \tab                          brokenDoors: SluiceDoor \to Bool = nothingBroken   \\
&                                 ).( \\
&  \tab ( \\
&  \tab\tab  \forall a,b:Place.[move(a,b)]X( \\
&  \tab\tab  \tab                              if(a \approx position, b, position), \\
&  \tab\tab  \tab                              projecting \wedge a \not \approx position, \\
&  \tab\tab  \tab                              projected, \\
&  \tab\tab  \tab                              if(a \approx position \wedge \exists s:Sluice . sluicePlace(s) \approx b \wedge ( \\
& \tab\tab\tab\tab (\neg projected \wedge brokenDoors(sluiceDoor(s, insideDoor))) \\ 
& \tab\tab\tab\tab \vee (projected \wedge brokenDoors(sluiceDoor(s, outsideDoor))) \\
& \tab\tab\tab ), true, stuck), \\
&  \tab\tab  \tab                              brokenDoors \\
&  \tab\tab                               ) \\
&  \tab\tab  \wedge [\overline{(\exists a,b:Place.move(a,b)) \cup beginProject \cup endProject} \\
& \tab\tab\tab\tab \overline{ \cup (\exists d:Door,s:Sluice.doorStuck(d, s))}]X( \\
& \tab\tab\tab\tab\tab\tab position, projecting, projected, stuck, brokenDoors) \\
&  \tab\tab  \wedge [beginProject]X(position, position \approx P, projected, stuck, brokenDoors) \\
&  \tab\tab  \wedge [endProject]X(\\
& \tab\tab\tab\tab position, false, projected \vee (projecting \wedge position \approx P),  stuck, brokenDoors \\
& \tab\tab\tab ) \\
&  \tab\tab  \wedge \forall d:Door,s:Sluice.[doorStuck(d, s)]X( \\
&  \tab\tab    \tab position,   projecting,  projected, \\
&  \tab\tab   \tab                        if(sluicePlace(s) \approx position \wedge ((\neg projected \wedge d \approx insideDoor) \\
& \tab\tab\tab\tab\tab \vee (projected \wedge d \approx outsideDoor)), true, stuck), \\
&  \tab\tab                       \tab brokenDoors[sluiceDoor(s,d)\to true] \\
&  \tab\tab                                              ) \\
&  \tab ) \\
&  \vee (position \approx RO \wedge projected) \\
& \vee stuck \\
& \vee (position != RO \\ 
& \tab \wedge \exists s1,s2:Sluice,d1,d2:Door.( \\
& \tab \tab brokenDoors(sluiceDoor(s1, d1)) \wedge brokenDoors(sluiceDoor(s2, d2)) \\
&\tab\tab \wedge s1 \not \approx s2 \wedge sluiceDoor(s1, d1) \not \approx sluiceDoor(s2, d2)) \\
&\tab ) \\
&)
	\end{align*}

 
 \item[4. Internal racks, sluices and the projector each contain at most one wafer]
    
\begin{align*}
		&[true^*] \nu X(status:Place \to WaferState=emptyPlaces).(\\
  & \tab\tab [\overline{((\exists a,b:Place.move(a,b)) \cup detectInputWafer)}]X(status)\\
  & \tab\tab  \wedge [detectInputWafer]X(status[RI \to unprojected])\\
  & \tab\tab  \wedge \forall a,b:Place.[move(a, b)](val(status(a) \not \approx empty \implies status(b)  \approx empty) \wedge \\ & \tab \tab X(status[b \to status(a)][a \to empty]))\\
&)
	\end{align*}

 
 \item[5. When the projector is at work, no interaction with the wafer is permissible]
 	\begin{align*}
 		&[true^*.beginProject().\overline{endProject()}^*.move(P,O)]false
	\end{align*}
	
 \item[6. A sluice door cannot open until the pressure on both sides is equal]
	\begin{align*}
&[true^*]\forall s:Sluice . ( \\
&\tab  [vacuum(s).stopPumping(s).\overline{readAirPressure(s, vacuum)}^*\\
&\tab\tab\tab.openDoor(insideDoor,s)]false \\
&\tab  \wedge [deVacuum(s).stopPumping(s).\overline{readAirPressure(s, normal)}^*\\
&\tab\tab\tab.openDoor(outsideDoor,s)]false \\
&)		
	\end{align*}
	
 \item[7. Sluice pumps cannot operate until both of its doors are closed]
 
 \begin{align*}
 &[true^*]\forall s:Sluice, d:Door . ( \\
 &\tab [openDoor(d,s).\overline{closeDoor(d,s)}*.vacuum(s)]false \\
 &\tab \wedge [openDoor(d,s).\overline{closeDoor(d,s)}*.deVacuum(s)]false \\
 &)
 \end{align*}

 \item[8. No robot can place a projected wafer in $RI$]\mbox{}\\

\begin{align*}
&[true^*] \nu X(status:Place \to WaferState=emptyPlaces).( \\
&\tab  [\overline{(\exists a,b:Place.move(a,b)) \vee detectInputWafer \vee endProject}]X(status) \\
&\tab  \wedge [detectInputWafer]X(status[RI \to unprojected]) \\
&\tab  \wedge \forall a,b:Place.[move(a, b)](((b \approx RI) \implies (status(a) \not \approx projected)) \\
&\tab\tab\tab \wedge X(status[b \to status(a)][a \to empty])) \\
&\tab  \wedge [endProject]X(status[P \to projected]) \\
&)
\end{align*}

 \item[9. No robot can place an unprojected wafer in $RO$] \mbox{}\\

\begin{align*}
&[true^*] \nu X(status:Place \to WaferState=emptyPlaces).( \\
&\tab  [\overline{(\exists a,b:Place.move(a,b)) \vee detectInputWafer \vee endProject}]X(status) \\
&\tab  \wedge [detectInputWafer]X(status[RI \to unprojected]) \\
&\tab  \wedge \forall a,b:Place.[move(a, b)](((b \approx RO) \implies (status(a) \not \approx unprojected)) \\
&\tab\tab\tab \wedge X(status[b \to status(a)][a \to empty])) \\
&\tab  \wedge [endProject]X(status[P \to projected]) \\
&)
\end{align*}

 \item[10. No robot can take a wafer from $RO$]

\[
	\forall p:Place . [true^* \cdot move(RO, p)]false
\]

\end{description}
